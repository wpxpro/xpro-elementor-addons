let frame,swatchConf=swatch_conf||{};jQuery(document).ready(function(a){"use strict";let d=window.wp,b=a("body");a("#term-color").wpColorPicker(),b.on("click",".xpro_upload_img_button",function(b){b.preventDefault();let c=a(this);frame||(frame=d.media.frames.downloadable_file=d.media({title:swatchConf.i18n.title,button:{text:swatchConf.i18n.button},multiple:!1})).on("select",function(){let a=frame.state().get("selection").first().toJSON();c.siblings("input.xpro_term_img").val(a.id),c.siblings(".xpro_remove_img_btn").show(),void 0!==a.sizes.thumbnail?c.parent().prev(".xpro_term_img_thumbnail").find("img").attr("src",a.sizes.thumbnail.url):c.parent().prev(".xpro_term_img_thumbnail").find("img").attr("src",a.url)}),frame.open()}).on("click",".xpro_remove_img_btn",function(){let b=a(this);return b.siblings("input.xpro_term_img").val(""),b.siblings(".xpro_remove_img_btn").hide(),b.parent().prev(".xpro_term_img_thumbnail").find("img").attr("src",swatchConf.dummy),!1});let c=a("#xpro_tpl_modal"),e=c.find(".spinner"),f=c.find(".message"),g=null;function h(){c.find(".xpro_term__name input, .xpro_term__slug input").val(""),e.removeClass("is-active"),f.removeClass("error success").hide(),c.hide()}b.on("click",".xpro_assign_new_attribute",function(f){f.preventDefault();let b=a(this),h=d.template("xpro__tpl_input__tax"),e={type:b.data("type"),tax:b.closest(".woocommerce_attribute").data("taxonomy")};c.find(".xpro_term__swatch").html(a("#tmpl-xpro__tpl_input__"+e.type).html()),c.find(".xpro_term__tax").html(h(e)),"color"==e.type&&c.find("input.xpro_input__color").wpColorPicker(),g=b.closest(".woocommerce_attribute.wc-metabox"),c.show()}).on("click",".xpro_modal__close, .xpro_modal__backdrop",function(a){a.preventDefault(),h()}),b.on("click",".xpro_add_attribute_submit",function(b){b.preventDefault(),a(this).data("type");let i=!1,_={};c.find(".xpro__input").each(function(){let b=a(this);"slug"===b.attr("name")||b.val()?b.removeClass("error"):(b.addClass("error"),i=!0),_[b.attr("name")]=b.val()}),i||(e.addClass("is-active"),f.hide(),d.ajax.send("xpro_add_new_attribute",{data:_,error:function(a){e.removeClass("is-active"),f.addClass("error").text(a).show()},success:function(a){e.removeClass("is-active"),f.addClass("success").text(a.msg).show(),g.find("select.attribute_values").append('<option value="'+a.id+'" selected="selected">'+a.name+"</option>"),g.find("select.attribute_values").change(),h()}}))})})